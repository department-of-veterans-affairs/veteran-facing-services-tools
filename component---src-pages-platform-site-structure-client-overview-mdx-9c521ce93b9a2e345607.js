(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{iiUM:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return p})),a.d(t,"_frontmatter",(function(){return c}));a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("91GP");var n=a("q1tI"),o=a.n(n),s=a("6qfE"),r=a("3dLD");var i={},p=function(e){var t,a;function n(t){var a;return(a=e.call(this,t)||this).layout=r.a,a}return a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,n.prototype.render=function(){var e=this.props,t=e.components,a=function(e,t){if(null==e)return{};var a,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,["components"]);return o.a.createElement(s.MDXTag,{name:"wrapper",Layout:this.layout,layoutProps:Object.assign({},i,a),components:t},o.a.createElement("h1",{id:"vagov-client-overview"},"VA.gov client overview"),o.a.createElement(s.MDXTag,{name:"p",components:t},"Welcome to the VA digital services platform front-end overview. The goal of this article is to provide a high level overview of our front end architecture to get you oriented with the ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://github.com/department-of-veterans-affairs/vets-website"}},"vets-website")," repository."),o.a.createElement(s.MDXTag,{name:"p",components:t},"The overall architecture for VA.gov is comprised of an API backend written in Ruby on Rails (",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://github.com/department-of-veterans-affairs/vets-api"}},"vets-api"),") and a static front-end, written in HTML, CSS, and Javascript (",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"vets-website"),"). There's no server-side rendering or processing for the front-end; the build process compiles everything into static resources which are served to users."),o.a.createElement("h2",{id:"build-process"},"Build process"),o.a.createElement(s.MDXTag,{name:"p",components:t},"The build process for this is controlled by a tool called ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"http://www.metalsmith.io/"}},"Metalsmith"),", which is a pluggable Node.js static site generator. In general, everything in Metalsmith is a plugin, so if you're looking for specific parts of the build process, expect to check out a plugin or two. We use Metalsmith because it's flexible and because it's Javascript based, it's easy to integrate with the rest of our tools."),o.a.createElement(s.MDXTag,{name:"p",components:t},"The build process has two primary kinds of functionality that it processes: static content pages and Javascript applications. Most of VA.gov consists of content that lives in Markdown files and is converted into HTML by a Metalsmith plugin. There are shared templates and other enhancements to make this content easier to structure. This content lives in ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"content/pages"),", which also provides the basic URL structure of the site."),o.a.createElement("h2",{id:"javascript-applications"},"Javascript applications"),o.a.createElement(s.MDXTag,{name:"p",components:t},"Javascript applications are the other type of functionality in vets-website. These applications are written in ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://reactjs.org/"}},"React")," and ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://redux.js.org/"}},"Redux")," and live in ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"src/applications/")," in ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"vets-website"),". For each app you'll find a ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"manifest.json")," file that contains application information. You'll find the root url of the application, which you can use to navigate to that application on the site. These applications also usually have client-side routes, so opening that root url may allow you to click to other pages that are fully client-side, and not based on pages in ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"content/pages"),"."),o.a.createElement(s.MDXTag,{name:"p",components:t},"If you're a developer, most of your time will likely be spent working on a React application. We use React because it's widely used by front end developers and provides a good balance of performance and approachability. We also use Redux to manage application state, also because it's commonly used with React and fits most of the applications on VA.gov well. We use ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://reacttraining.com/react-router/"}},"React Router")," for client-side routing and ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://webpack.js.org/"}},"Webpack")," as a build tool, both of which are the ",o.a.createElement(s.MDXTag,{name:"em",components:t,parentName:"p"},"de facto")," standards in the Javascript world. For styles we use ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://sass-lang.com/"}},"Sass")," and for dependency management we use ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://yarnpkg.com/en/"}},"Yarn"),"."),o.a.createElement("h2",{id:"design-system"},"Design system"),o.a.createElement(s.MDXTag,{name:"p",components:t},"You will also find that our visual components and site-wide styles live in an external ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://department-of-veterans-affairs.github.io/design-system/"}},"design system"),". This design system is based on the ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://designsystem.digital.gov/"}},"US Web Design System"),", with some additional modifications by our team. As part of that design system, we provide a set of React components covering common patterns, which is ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://www.npmjs.com/package/@department-of-veterans-affairs/formation"}},"published to npm"),". You'll likely use these components to make your apps accessible and consistent with the rest of VA.gov."),o.a.createElement("h2",{id:"routing-for-react-apps"},"Routing for React apps"),o.a.createElement("h3",{id:"production"},"Production"),o.a.createElement(s.MDXTag,{name:"p",components:t},"The production deployment of the vet-website front end consists of static HTML, CSS, and JS assets deployed to an Amazon S3 bucket. We have an nginx server that serves those static assets and does some extra route handling for our single page React apps."),o.a.createElement(s.MDXTag,{name:"p",components:t},"React applications have a single entry page in the ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"content/pages")," folder and a special nginx ",o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"p",props:{href:"https://github.com/department-of-veterans-affairs/devops/blob/master/ansible/deployment/config/revproxy-vetsgov/vars/react_routes.yml"}},"config entry"),". Each of the React applications listed in that config are standalone single page apps, and for each of the urls listed in that section of the config, the nginx server routes anything that starts with that url to the static page at that url, instead of trying to find a content page at that spot in the ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"content/pages")," folder structure. See the example below for a step by step view of that process."),o.a.createElement(s.MDXTag,{name:"p",components:t},"When that page is loaded and the JS bundle is downloaded and parsed, React Router sees the original route, removes the base url specified in the entry page from it, and routes to the page configured in the routes for the React app."),o.a.createElement(s.MDXTag,{name:"p",components:t},"In summary, nginx routes a variety of different urls to the same static entry page, and React Router renders the correct component based on the route configuration client side."),o.a.createElement("h4",{id:"example"},"Example"),o.a.createElement(s.MDXTag,{name:"p",components:t},"Here's an example using the claim status application:"),o.a.createElement(s.MDXTag,{name:"ol",components:t},o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ol"},"User opens ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"va.gov/track-claims/your-claims/2344/detail")),o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ol"},"Nginx serves ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"va.gov/track-claims/index.html"),", because ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"/track-claims")," is configured as a React application"),o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ol"},"In the browser, the JS bundle loads and React Router sees a url of ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"/track-claims/your-claims/2344/detail")),o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ol"},"Since React Router has a base url of ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"/track-claims"),", it runs its routing logic on ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"li"},"/your-claims/2344/detail"),", and renders the appropriate component for that url.")),o.a.createElement(s.MDXTag,{name:"p",components:t},"One other thing to note is that links that use the ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"Link")," component or the ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"router")," object in the React app use the history api to change the url without reloading the page. React Router listens for these url changes and renders the right component for you. This is why you have to use ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"Link")," and not a regular ",o.a.createElement(s.MDXTag,{name:"inlineCode",components:t,parentName:"p"},"a")," element, which results in a page refresh for the url you're trying to link to."),o.a.createElement("h3",{id:"development"},"Development"),o.a.createElement(s.MDXTag,{name:"p",components:t},"Locally, we've configured the webpack dev server to do the same redirects as nginx, however they are duplicated in a couple places:"),o.a.createElement(s.MDXTag,{name:"ul",components:t},o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ul"},o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"li",props:{href:"https://github.com/department-of-veterans-affairs/vets-website/blob/master/script/build.js"}},"script/build.js")),o.a.createElement(s.MDXTag,{name:"li",components:t,parentName:"ul"},o.a.createElement(s.MDXTag,{name:"a",components:t,parentName:"li",props:{href:"https://github.com/department-of-veterans-affairs/vets-website/blob/master/src/platform/testing/e2e/test-server.js"}},"src/platform/testing/e2e/test-server.js")," (for e2e tests)")),o.a.createElement(s.MDXTag,{name:"p",components:t},"You will need to update these locations as well as the nginx config when creating a new React application."))},n}(o.a.Component),c={}}}]);
//# sourceMappingURL=component---src-pages-platform-site-structure-client-overview-mdx-9c521ce93b9a2e345607.js.map