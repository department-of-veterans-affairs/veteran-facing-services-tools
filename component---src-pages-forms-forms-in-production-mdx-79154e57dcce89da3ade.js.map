{"version":3,"sources":["webpack:///./src/components/sidebar/SidebarItems.jsx","webpack:///./src/components/sidebar/Sidebar.js","webpack:///./src/components/EditLink.jsx","webpack:///./src/layouts/SidebarLayout.jsx","webpack:///./src/pages/forms/forms-in-production.mdx","webpack:///./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"names":["SidebarItem","item","href","key","name","to","SidebarItems","items","isSublist","length","className","map","Sidebar","location","sidebarSection","sidebarData","sections","find","section","pathname","includes","EditLink","sourceUrl","class","aria-hidden","SidebarLayout","children","pageContext","Layout","id","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent","_objectWithoutPropertiesLoose","source","excluded","i","target","sourceKeys","Object","keys","indexOf"],"mappings":"qKASA,SAASA,EAAT,GAAgC,IAATC,EAAQ,EAARA,KACrB,OAAIA,EAAKC,KAEL,wBAAIC,IAAKF,EAAKG,MACZ,kBAAC,OAAD,CAAMC,GAAIJ,EAAKC,MAAOD,EAAKG,OAI1B,wBAAID,IAAKF,EAAKG,MAAOH,EAAKG,KAA1B,aAGM,SAASE,EAAT,GAAqD,IAA7BC,EAA4B,EAA5BA,MAA4B,IAArBC,iBAAqB,SACjE,OAAKD,EAAME,OAKT,wBAAIC,UAAU,uBACXH,EAAMI,KAAI,SAAAV,GACT,OAAIA,EAAKM,MAEL,wBAAIJ,IAAKF,EAAKG,MACXI,GAAa,kBAACR,EAAD,CAAaC,KAAMA,KAC/BO,GAAa,wBAAIE,UAAU,mBAAmBT,EAAKG,MACrD,kBAACE,EAAD,CAAcE,WAAS,EAACD,MAAON,EAAKM,SAInC,kBAACP,EAAD,CAAaC,KAAMA,EAAME,IAAKF,EAAKG,WAfvC,K,yBCZI,SAASQ,EAAT,GAAgC,IAAbC,EAAY,EAAZA,SAC1BC,EAAiBC,IAAYC,SAASC,MAAK,SAAAC,GAAO,OACtDL,EAASM,SAASC,SAASF,EAAQhB,SAGrC,OAAKY,EAKH,yBAAKJ,UAAU,qCACb,yBAAKA,UAAU,kBACb,kBAACJ,EAAD,CAAcC,MAAOO,EAAeP,UANjC,KCdI,SAASc,EAAT,GAAkC,IAAdC,EAAa,EAAbA,UACjC,OAAOA,EACL,6BACE,uBAAGC,MAAM,aAAaC,cAAY,SAAU,IAC5C,uBAAGtB,KAAMoB,GAAT,6BAEA,K,gBCKS,SAASG,EAAT,GAA6D,IAApCC,EAAmC,EAAnCA,SAAUb,EAAyB,EAAzBA,SAAUc,EAAe,EAAfA,YAC1D,OACE,kBAACC,EAAA,EAAD,CAAQf,SAAUA,GAChB,yBAAKH,UAAU,cACb,kBAACE,EAAD,CAASC,SAAUA,IACnB,yBACEgB,GAAG,eACHnB,UAAU,2DAETgB,EACD,kBAACL,EAAD,CAAUC,UAAWK,EAAYL,iB,mMCf9BQ,EAAe,GACtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,EACF,iBACD,OAAO,YAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,kBACE,GAAM,uBADR,uBAGA,kCAAiB,iBAAGC,WAAW,IAC3B,KAAQ,iCADK,oCAGjB,gHACA,kBACE,GAAM,6BADR,6BAGA,seACA,yXACA,iEACA,uBAAK,oBAAMA,WAAW,MAClB,UAAa,eADZ,sOAiBL,8IAA6H,0BAAYA,WAAW,KAAvB,YAA7H,KAAuL,0BAAYA,WAAW,KAAvB,YAAvL,SAAqP,0BAAYA,WAAW,KAAvB,UAArP,2CAAmV,0BAAYA,WAAW,KAAvB,YAAnV,QAAgZ,0BAAYA,WAAW,KAAvB,YAAhZ,yIACA,uBAAK,oBAAMA,WAAW,MAClB,UAAa,eADZ,sVAaL,kKAAiJ,0BAAYA,WAAW,KAAvB,YAAjJ,iCACA,iHACA,uBAAK,oBAAMA,WAAW,MAClB,UAAa,eADZ,oZAcL,6EAA4D,0BAAYA,WAAW,KAAvB,2BAA5D,2CACA,uJAKJJ,EAAWK,gBAAiB,G,kCCtFb,SAASC,EAA8BC,EAAQC,GAC5D,GAAc,MAAVD,EAAgB,MAAO,GAC3B,IAEItC,EAAKwC,EAFLC,EAAS,GACTC,EAAaC,OAAOC,KAAKN,GAG7B,IAAKE,EAAI,EAAGA,EAAIE,EAAWpC,OAAQkC,IACjCxC,EAAM0C,EAAWF,GACbD,EAASM,QAAQ7C,IAAQ,IAC7ByC,EAAOzC,GAAOsC,EAAOtC,IAGvB,OAAOyC,EAZT","file":"component---src-pages-forms-forms-in-production-mdx-79154e57dcce89da3ade.js","sourcesContent":["import React from 'react';\nimport { Link } from 'gatsby';\n\n/**\n * Sidebar\n *\n * @param {props} props\n */\n\nfunction SidebarItem({ item }) {\n  if (item.href) {\n    return (\n      <li key={item.name}>\n        <Link to={item.href}>{item.name}</Link>\n      </li>\n    );\n  }\n  return <li key={item.name}>{item.name} (future)</li>;\n}\n\nexport default function SidebarItems({ items, isSublist = false }) {\n  if (!items.length) {\n    return null;\n  }\n\n  return (\n    <ul className=\"site-c-sidenav-list\">\n      {items.map(item => {\n        if (item.items) {\n          return (\n            <li key={item.name}>\n              {isSublist && <SidebarItem item={item} />}\n              {!isSublist && <h2 className=\"heading-level-4\">{item.name}</h2>}\n              <SidebarItems isSublist items={item.items} />\n            </li>\n          );\n        }\n        return <SidebarItem item={item} key={item.name} />;\n      })}\n    </ul>\n  );\n}\n","import React from 'react';\nimport SidebarItems from './SidebarItems';\nimport sidebarData from '../../sidebar';\n\n/**\n * Sidebar\n *\n * @param {props} props\n */\n\nexport default function Sidebar({ location }) {\n  const sidebarSection = sidebarData.sections.find(section =>\n    location.pathname.includes(section.href),\n  );\n\n  if (!sidebarSection) {\n    return null;\n  }\n\n  return (\n    <div className=\"vads-l-col--4 site-c-content__nav\">\n      <div className=\"site-c-sidenav\">\n        <SidebarItems items={sidebarSection.items} />\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function EditLink({ sourceUrl }) {\n  return sourceUrl ? (\n    <div>\n      <i class=\"fa fa-edit\" aria-hidden=\"true\" />{' '}\n      <a href={sourceUrl}>Edit this page on GitHub</a>\n    </div>\n  ) : null;\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Sidebar from '../components/sidebar/Sidebar';\nimport EditLink from '../components/EditLink';\nimport Layout from './Layout';\n\n/**\n * SidebarLayout\n *\n * @class SidebarLayout\n * @extends {React.Component}\n */\nexport default function SidebarLayout({ children, location, pageContext }) {\n  return (\n    <Layout location={location}>\n      <div className=\"vads-l-row\">\n        <Sidebar location={location} />\n        <div\n          id=\"main-content\"\n          className=\"vads-l-col--8 site-c-content__content docSearch-content\"\n        >\n          {children}\n          <EditLink sourceUrl={pageContext.sourceUrl} />\n        </div>\n      </div>\n    </Layout>\n  );\n}\n\nSidebarLayout.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/jenkins/workspace/ran-facing-services-tools_master/packages/documentation/src/layouts/SidebarLayout.jsx\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"forms-in-production\"\n    }}>{`Forms in production`}</h1>\n    <p>{`Previous: `}<a parentName=\"p\" {...{\n        \"href\": \"./forms/save-in-progress-menu\"\n      }}>{`Using the Save in Progress menu`}</a></p>\n    <p>{`Now that you have a form in production, making future changes requires some extra care.`}</p>\n    <h2 {...{\n      \"id\": \"changing-your-form-schema\"\n    }}>{`Changing your form schema`}</h2>\n    <p>{`Once you're in production and you're also using the save in progress functionality, you have a dilemma when you want to change some fields or some validation on your form. Since there are forms that are saved, if you change the structure of the form, the saved data may no longer match and result in confusing validation errors for a user. Similarly, if validation changes, a user might have already gone past that field and won't know how to fix the new error.`}</p>\n    <p>{`To address this issue, we have the ability to write \"migrations\" for form data. This way, you can update a user's data to match the new structure, as well as move their position in the form back, if they need to adjust something. Migrations are functions, run in a sequence, based on the \"version\" of the form, which is saved along with the form data.`}</p>\n    <p>{`Migrations go in the form config object:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`const formConfig = {\n   ...\n   version: 1,\n   migrations: [\n     ({ formData, metadata, formId }) => {\n       // do something\n       return {\n         formData,\n         metadata\n       };\n     }\n   ]\n   ...\n};\n`}</code></pre>\n    <p>{`We typically start at version 0 and increment each time we need to add a migration. Migrations are functions that get `}<inlineCode parentName=\"p\">{`formData`}</inlineCode>{`, `}<inlineCode parentName=\"p\">{`metadata`}</inlineCode>{`, and `}<inlineCode parentName=\"p\">{`formId`}</inlineCode>{` as arguments. And they must return the `}<inlineCode parentName=\"p\">{`formData`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`metadata`}</inlineCode>{`, with any changes that they have made. For example, here is a migration that the health care application uses to convert an old url:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`({ formData, metadata }) => {\n  const url = metadata.returnUrl || metadata.return_url;\n  let newMetadata = metadata;\n\n  if (url === '/household-information/child-information') {\n    newMetadata = _.set('returnUrl', '/household-information/dependent-information', metadata);\n  }\n\n  return { formData, metadata: newMetadata };\n}\n`}</code></pre>\n    <p>{`If the current return URL (which is the URL a user will return to when the load a saved form) matches the outdated one, we update it. The `}<inlineCode parentName=\"p\">{`formData`}</inlineCode>{` is not changed in this case.`}</p>\n    <p>{`Another example from the health care application was to fix a bug in our form structure:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`(savedData) => {\n  const newData = savedData;\n  newData.formData = _.unset('isSpanishHispanicLatino', savedData.formData);\n\n  if (typeof _.get('view:demographicCategories.isSpanishHispanicLatino', newData.formData) === 'undefined') {\n    newData.formData = _.set('view:demographicCategories.isSpanishHispanicLatino', false, newData.formData);\n    return newData;\n  }\n\n  return newData;\n}\n`}</code></pre>\n    <p>{`In this example, we're moving an incorrectly located `}<inlineCode parentName=\"p\">{`isSpanishHispanicLatino`}</inlineCode>{` flag and setting it in the right spot.`}</p>\n    <p>{`Writing migrations is not very common, but you may need to do it if you end up modifying a form that's already in production.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}"],"sourceRoot":""}