(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{"1nT/":function(e){e.exports=JSON.parse('{"data":{"components":{"edges":[{"node":{"path":"/visual-design/components/accepttermsprompt/","context":{"source":"component","name":"AcceptTermsPrompt"}}},{"node":{"path":"/visual-design/components/additionalinfo/","context":{"source":"component","name":"AdditionalInfo"}}},{"node":{"path":"/visual-design/components/alertbox/","context":{"source":"component","name":"AlertBox"}}},{"node":{"path":"/visual-design/components/breadcrumbs/","context":{"source":"component","name":"Breadcrumbs"}}},{"node":{"path":"/visual-design/components/collapsiblepanel/","context":{"source":"component","name":"CollapsiblePanel"}}},{"node":{"path":"/visual-design/components/dropdownpanel/","context":{"source":"component","name":"DropDownPanel"}}},{"node":{"path":"/visual-design/components/errorablecheckbox/","context":{"source":"component","name":"ErrorableCheckbox"}}},{"node":{"path":"/visual-design/components/errorablecheckboxgroup/","context":{"source":"component","name":"ErrorableCheckboxGroup"}}},{"node":{"path":"/visual-design/components/errorabledate/","context":{"source":"component","name":"ErrorableDate"}}},{"node":{"path":"/visual-design/components/errorablefileinput/","context":{"source":"component","name":"ErrorableFileInput"}}},{"node":{"path":"/visual-design/components/errorablemonthyear/","context":{"source":"component","name":"ErrorableMonthYear"}}},{"node":{"path":"/visual-design/components/errorablenumberinput/","context":{"source":"component","name":"ErrorableNumberInput"}}},{"node":{"path":"/visual-design/components/errorableradiobuttons/","context":{"source":"component","name":"ErrorableRadioButtons"}}},{"node":{"path":"/visual-design/components/errorableselect/","context":{"source":"component","name":"ErrorableSelect"}}},{"node":{"path":"/visual-design/components/errorabletextarea/","context":{"source":"component","name":"ErrorableTextArea"}}},{"node":{"path":"/visual-design/components/errorabletextinput/","context":{"source":"component","name":"ErrorableTextInput"}}},{"node":{"path":"/visual-design/components/expandinggroup/","context":{"source":"component","name":"ExpandingGroup"}}},{"node":{"path":"/visual-design/components/helpmenu/","context":{"source":"component","name":"HelpMenu"}}},{"node":{"path":"/visual-design/components/iconbase/","context":{"source":"component","name":"IconBase"}}},{"node":{"path":"/visual-design/components/iconhelp/","context":{"source":"component","name":"IconHelp"}}},{"node":{"path":"/visual-design/components/iconsearch/","context":{"source":"component","name":"IconSearch"}}},{"node":{"path":"/visual-design/components/iconuser/","context":{"source":"component","name":"IconUser"}}},{"node":{"path":"/visual-design/components/loadingindicator/","context":{"source":"component","name":"LoadingIndicator"}}},{"node":{"path":"/visual-design/components/megamenu/","context":{"source":"component","name":"MegaMenu"}}},{"node":{"path":"/visual-design/components/modal/","context":{"source":"component","name":"Modal"}}},{"node":{"path":"/visual-design/components/ombinfo/","context":{"source":"component","name":"OMBInfo"}}},{"node":{"path":"/visual-design/components/pagination/","context":{"source":"component","name":"Pagination"}}},{"node":{"path":"/visual-design/components/privacyagreement/","context":{"source":"component","name":"PrivacyAgreement"}}},{"node":{"path":"/visual-design/components/progressbar/","context":{"source":"component","name":"ProgressBar"}}},{"node":{"path":"/visual-design/components/progressbutton/","context":{"source":"component","name":"ProgressButton"}}},{"node":{"path":"/visual-design/components/promobanner/","context":{"source":"component","name":"PromoBanner"}}},{"node":{"path":"/visual-design/components/searchmenu/","context":{"source":"component","name":"SearchMenu"}}},{"node":{"path":"/visual-design/components/segmentedprogressbar/","context":{"source":"component","name":"SegmentedProgressBar"}}},{"node":{"path":"/visual-design/components/sortabletable/","context":{"source":"component","name":"SortableTable"}}},{"node":{"path":"/visual-design/components/systemdownview/","context":{"source":"component","name":"SystemDownView"}}},{"node":{"path":"/visual-design/components/telephone/","context":{"source":"component","name":"Telephone"}}}]}}}')},"3dLD":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("q1tI"),o=n.n(a),r=n("8FPV"),c=(n("gu/5"),n("eoYm"),n("v9g0"),n("pJf4"),n("1nT/")),m=n("Wbzz");function i(){return o.a.createElement(m.StaticQuery,{query:"4277382034",render:function(e){return o.a.createElement(s,{items:e.components.edges.map((function(e){return{href:e.node.path,name:e.node.context.name}}))})},data:c})}function l(e){var t=e.item;return t.href?o.a.createElement("li",{key:t.name},o.a.createElement(m.Link,{to:t.href},t.name)):o.a.createElement("li",{key:t.name},t.name," (future)")}function s(e){var t=e.items,n=e.isSublist,a=void 0!==n&&n;return t.length?o.a.createElement("ul",{className:"site-c-sidenav-list"},t.map((function(e){return e.items?o.a.createElement("li",{key:e.name},a&&o.a.createElement(l,{item:e}),!a&&o.a.createElement("h2",{className:"heading-level-4"},e.name),o.a.createElement(s,{isSublist:!0,items:e.items})):"componentList"===e.query?o.a.createElement("li",{key:e.name},a&&o.a.createElement(l,{item:e}),!a&&o.a.createElement("h2",{className:"heading-level-4"},e.name),o.a.createElement(i,null)):o.a.createElement(l,{item:e,key:e.name})}))):null}var d=n("MEl4"),p=n.n(d);function u(e){var t=e.location,n=p.a.sections.find((function(e){return t.pathname.includes(e.href)}));return n?o.a.createElement("div",{className:"vads-l-col--4 site-c-content__nav"},o.a.createElement("div",{className:"site-c-sidenav"},o.a.createElement(s,{items:n.items}))):null}function b(e){var t=e.children,n=e.location;return o.a.createElement(r.a,{location:n},o.a.createElement("div",{className:"vads-l-row"},o.a.createElement(u,{location:n}),o.a.createElement("div",{id:"main-content",className:"vads-l-col--8 site-c-content__content docSearch-content"},t)))}},bAeu:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return r})),n.d(t,"default",(function(){return i}));n("rzGZ"),n("Dq+y"),n("8npG"),n("Ggvi"),n("E5k/"),n("q1tI");var a=n("7ljp"),o=n("3dLD");var r={},c={_frontmatter:r},m=o.a;function i(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["components"]);return Object(a.mdx)(m,Object.assign({},c,n,{components:t,mdxType:"MDXLayout"}),Object(a.mdx)("h1",{id:"run-and-build-vagov"},"Run and build VA.gov"),Object(a.mdx)("h2",{id:"prerequisite"},"Prerequisite"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},"Complete the ",Object(a.mdx)("a",Object.assign({parentName:"li"},{href:"/veteran-facing-services-tools/getting-started"}),"first")," step in ",Object(a.mdx)("em",{parentName:"li"},"Start up guide"),".")),Object(a.mdx)("h2",{id:"locally-run-vagov"},"Locally run VA.gov"),Object(a.mdx)("p",null,"Start the watch task:"),Object(a.mdx)("pre",null,Object(a.mdx)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"yarn watch\n")),Object(a.mdx)("h3",{id:"build"},"Build"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"Metalsmith")," manages this build pipeline. At a high level, this process:",Object(a.mdx)("ol",{parentName:"li"},Object(a.mdx)("li",{parentName:"ol"},"retrieves and ",Object(a.mdx)("strong",{parentName:"li"},"builds")," all of the ",Object(a.mdx)("strong",{parentName:"li"},"static pages")," sourced from ",Object(a.mdx)("inlineCode",{parentName:"li"},"vagov-content")," or Drupal"),Object(a.mdx)("li",{parentName:"ol"},"starts ",Object(a.mdx)("strong",{parentName:"li"},"Webpack"),"'s devevelopment server which",Object(a.mdx)("ul",{parentName:"li"},Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"builds")," the ",Object(a.mdx)("strong",{parentName:"li"},"JavaScript")," and ",Object(a.mdx)("strong",{parentName:"li"},"CSS")," bundles, and"),Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"serves")," the ",Object(a.mdx)("strong",{parentName:"li"},"JavaScript")," and ",Object(a.mdx)("strong",{parentName:"li"},"CSS")," bundles and the ",Object(a.mdx)("strong",{parentName:"li"},"static content")," built by Metalsmith at ",Object(a.mdx)("a",Object.assign({parentName:"li"},{href:"http://localhost:3000"}),"http://localhost:3000"))))))),Object(a.mdx)("h3",{id:"output"},"Output"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"Metalsmith")," outputs ",Object(a.mdx)("strong",{parentName:"li"},"static pages")," to",Object(a.mdx)("inlineCode",{parentName:"li"},"build/localhost")),Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"Webpack")," development server has ",Object(a.mdx)("strong",{parentName:"li"},"no output"),". ",Object(a.mdx)("strong",{parentName:"li"},"JavaScript")," and ",Object(a.mdx)("strong",{parentName:"li"},"CSS")," are kept in memory.")),Object(a.mdx)("h3",{id:"watch-and-rebuild"},"Watch and rebuild"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"Metalsmith")," will rebuild ",Object(a.mdx)("strong",{parentName:"li"},"static pages")," when changes are saved to ",Object(a.mdx)("strong",{parentName:"li"},"templates")," or content in ",Object(a.mdx)("inlineCode",{parentName:"li"},"vagov-content")),Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"Webpack")," development server will rebuild when changes are saved to ",Object(a.mdx)("strong",{parentName:"li"},"JavaScript")," or ",Object(a.mdx)("strong",{parentName:"li"},"SCSS")),Object(a.mdx)("li",{parentName:"ul"},"Both updates require a browser refresh to see changes."),Object(a.mdx)("li",{parentName:"ul"},"Changes to build process or configuration files are typically not picked up, and require a restart of the watch task to become active.")),Object(a.mdx)("h2",{id:"locally-build-and-run-for-specific-environment"},"Locally build and run for specific environment"),Object(a.mdx)("p",null,Object(a.mdx)("em",{parentName:"p"},"Note: most of the time, it's better to use the ",Object(a.mdx)("inlineCode",{parentName:"em"},"watch")," task to build the site locally since it is the most developer-friendly experience.")),Object(a.mdx)("table",null,Object(a.mdx)("thead",{parentName:"table"},Object(a.mdx)("tr",{parentName:"thead"},Object(a.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"Environment"),Object(a.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"Build Command"),Object(a.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"Output directory"),Object(a.mdx)("th",Object.assign({parentName:"tr"},{align:null}),"Run Command"))),Object(a.mdx)("tbody",{parentName:"table"},Object(a.mdx)("tr",{parentName:"tbody"},Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"localhost"),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"yarn build")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"build/localhost")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"npx http-server -p 3001 build/localhost"))),Object(a.mdx)("tr",{parentName:"tbody"},Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"dev.va.gov"),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"yarn build --buildtype=vagovdev")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"build/vagovdev")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"npx http-server -p 3001 build/vagovdev"))),Object(a.mdx)("tr",{parentName:"tbody"},Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),"staging.va.gov"),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"NODE_ENV=production yarn build --buildtype=vagovstaging")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"build/vagovstaging")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"npx http-server -p 3001 build/vagovstaging"))),Object(a.mdx)("tr",{parentName:"tbody"},Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("a",Object.assign({parentName:"td"},{href:"http://www.va.gov"}),"www.va.gov")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"NODE_ENV=production yarn build --buildtype=vagovprod")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"build/vagovprod")),Object(a.mdx)("td",Object.assign({parentName:"tr"},{align:null}),Object(a.mdx)("inlineCode",{parentName:"td"},"npx http-server -p 3001 build/vagovprod"))))),Object(a.mdx)("h3",{id:"build-commands"},"Build commands"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"create")," the ",Object(a.mdx)("strong",{parentName:"li"},"static pages")," from the markdown content in the ",Object(a.mdx)("inlineCode",{parentName:"li"},"vagov-content")," repository and data queried from the Drupal API into their ",Object(a.mdx)("strong",{parentName:"li"},"output directory")),Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"create")," the ",Object(a.mdx)("strong",{parentName:"li"},"JavaScript")," and ",Object(a.mdx)("strong",{parentName:"li"},"CSS")," files with Webpack into ",Object(a.mdx)("inlineCode",{parentName:"li"},"/generated")," folder in their ",Object(a.mdx)("strong",{parentName:"li"},"output directory")," with Webpack")),Object(a.mdx)("p",null,Object(a.mdx)("em",{parentName:"p"},"Production like builds are required for staging and production environments. ",Object(a.mdx)("strong",{parentName:"em"},"NODE_ENV=production")," environment variable is required to be set when running these build commands")),Object(a.mdx)("h3",{id:"run-commands"},"Run commands"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("strong",{parentName:"li"},"start")," an ",Object(a.mdx)("inlineCode",{parentName:"li"},"http-server")," that ",Object(a.mdx)("strong",{parentName:"li"},"serves")," the ",Object(a.mdx)("strong",{parentName:"li"},"static pages")," from the ",Object(a.mdx)("strong",{parentName:"li"},"output directory")," at ",Object(a.mdx)("a",Object.assign({parentName:"li"},{href:"https://localhost:3001"}),"http://localhost:3001"))),Object(a.mdx)("p",null,Object(a.mdx)("em",{parentName:"p"},"Typically, the reason for building the site locally like this is to build it in production mode and check that it is behaving as you'd expect.")),Object(a.mdx)("p",null,Object(a.mdx)("em",{parentName:"p"},Object(a.mdx)("strong",{parentName:"em"},"Deep-linking")," to urls that are rendered by ",Object(a.mdx)("strong",{parentName:"em"},"React")," apps on VA.gov ",Object(a.mdx)("strong",{parentName:"em"},"will not work")," when you run the site this way, as that relies on some server-side routing that is handled in nginx (or the Webpack dev server when running the ",Object(a.mdx)("inlineCode",{parentName:"em"},"watch")," task)")),Object(a.mdx)("h2",{id:"related-source"},"Related source"),Object(a.mdx)("ul",null,Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("a",Object.assign({parentName:"li"},{href:"https://github.com/department-of-veterans-affairs/devops"}),"Metalsmith build script")),Object(a.mdx)("li",{parentName:"ul"},Object(a.mdx)("a",Object.assign({parentName:"li"},{href:"https://github.com/department-of-veterans-affairs/vets-website/blob/master/config/webpack.dev.config.js"}),"Webpack development server config"))))}i.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-getting-started-common-tasks-run-build-mdx-4c6c1becb758c2eacea3.js.map